import {
  require_jsx_runtime
} from "./chunk-OT5EQO2H.js";
import {
  require_react
} from "./chunk-OU5AQDZK.js";
import {
  __toESM
} from "./chunk-EWTE5DHJ.js";

// node_modules/react-linkedin-login-oauth2/build/index.esm.js
var import_react = __toESM(require_react());
var import_jsx_runtime = __toESM(require_jsx_runtime());
function i(t2) {
  var o2 = t2.redirectUri, i2 = t2.clientId, c2 = t2.onSuccess, a2 = t2.onError, s = t2.scope, d = void 0 === s ? "r_emailaddress" : s, u = t2.state, l = void 0 === u ? "" : u, w = t2.closePopupMessage, p = void 0 === w ? "User closed the popup" : w, g = (0, import_react.useRef)(null), v = (0, import_react.useRef)(null), f = (0, import_react.useCallback)(function(e2) {
    var r2 = localStorage.getItem("linkedin_oauth2_state");
    if (e2.origin === window.location.origin) {
      if (e2.data.errorMessage && "Linked In" === e2.data.from) {
        if (e2.data.state !== r2) return void (g.current && g.current.close());
        a2 && a2(e2.data), g.current && g.current.close();
      } else if (e2.data.code && "Linked In" === e2.data.from) {
        if (e2.data.state !== r2) return void (g.current && g.current.close());
        c2 && c2(e2.data.code), g.current && g.current.close();
      }
    }
  }, [a2, c2]);
  (0, import_react.useEffect)(function() {
    return function() {
      window.removeEventListener("message", f, false), g.current && (g.current.close(), g.current = null), v.current && (window.clearInterval(v.current), v.current = null);
    };
  }, [f]), (0, import_react.useEffect)(function() {
    return window.addEventListener("message", f, false), function() {
      window.removeEventListener("message", f, false);
    };
  }, [f]);
  var h = function() {
    var e2 = "&scope=" + encodeURI(d), r2 = l || function(e3) {
      void 0 === e3 && (e3 = 20);
      for (var r3 = "", n2 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", t3 = n2.length, o3 = 0; o3 < e3; o3++) r3 += n2.charAt(Math.floor(Math.random() * t3));
      return r3;
    }();
    return localStorage.setItem("linkedin_oauth2_state", r2), "https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=" + i2 + "&redirect_uri=" + o2 + e2 + "&state=" + r2;
  };
  return { linkedInLogin: function() {
    var e2;
    null === (e2 = g.current) || void 0 === e2 || e2.close(), g.current = window.open(h(), "_blank", function(e3) {
      var r2 = e3.width, n2 = void 0 === r2 ? 600 : r2, t3 = e3.height, o3 = void 0 === t3 ? 600 : t3;
      return "left=" + (screen.width / 2 - n2 / 2) + ",top=" + (screen.height / 2 - o3 / 2) + ",width=" + n2 + ",height=" + o3;
    }({ width: 600, height: 600 })), v.current && (window.clearInterval(v.current), v.current = null), v.current = window.setInterval(function() {
      try {
        g.current && g.current.closed && (window.clearInterval(v.current), v.current = null, a2 && a2({ error: "user_closed_popup", errorMessage: p }));
      } catch (e3) {
        window.clearInterval(v.current), v.current = null;
      }
    }, 1e3);
  } };
}
function c(e2) {
  return (0, e2.children)({ linkedInLogin: i({ redirectUri: e2.redirectUri, clientId: e2.clientId, onSuccess: e2.onSuccess, onError: e2.onError, state: e2.state, scope: e2.scope, closePopupMessage: e2.closePopupMessage }).linkedInLogin });
}
function a() {
  var e2 = (0, import_react.useState)(""), r2 = e2[0], i2 = e2[1];
  return (0, import_react.useEffect)(function() {
    var e3 = function(e4) {
      for (var r4 = e4.substring(1).split("&"), n2 = {}, t2 = 0; t2 < r4.length; t2++) {
        var o2 = r4[t2].split("=");
        o2.length > 1 && (n2[decodeURIComponent(o2[0])] = decodeURIComponent(o2[1]));
      }
      return n2;
    }(window.location.search);
    if (e3.state !== localStorage.getItem("linkedin_oauth2_state")) i2("State does not match");
    else if (e3.error) {
      var r3 = e3.error_description || "Login failed. Please try again.";
      window.opener && window.opener.postMessage({ error: e3.error, state: e3.state, errorMessage: r3, from: "Linked In" }, window.location.origin), "user_cancelled_login" === e3.error && window.close();
    }
    e3.code && window.opener && window.opener.postMessage({ code: e3.code, state: e3.state, from: "Linked In" }, window.location.origin);
  }, []), (0, import_jsx_runtime.jsx)("div", { children: r2 }, void 0);
}
export {
  c as LinkedIn,
  a as LinkedInCallback,
  i as useLinkedIn
};
//# sourceMappingURL=react-linkedin-login-oauth2.js.map
