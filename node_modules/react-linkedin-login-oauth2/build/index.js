"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("react/jsx-runtime");function n(r){var n=r.redirectUri,t=r.clientId,o=r.onSuccess,i=r.onError,c=r.scope,a=void 0===c?"r_emailaddress":c,s=r.state,u=void 0===s?"":s,d=r.closePopupMessage,l=void 0===d?"User closed the popup":d,w=e.useRef(null),f=e.useRef(null),p=e.useCallback((function(e){var r=localStorage.getItem("linkedin_oauth2_state");if(e.origin===window.location.origin)if(e.data.errorMessage&&"Linked In"===e.data.from){if(e.data.state!==r)return void(w.current&&w.current.close());i&&i(e.data),w.current&&w.current.close()}else if(e.data.code&&"Linked In"===e.data.from){if(e.data.state!==r)return void(w.current&&w.current.close());o&&o(e.data.code),w.current&&w.current.close()}}),[i,o]);e.useEffect((function(){return function(){window.removeEventListener("message",p,!1),w.current&&(w.current.close(),w.current=null),f.current&&(window.clearInterval(f.current),f.current=null)}}),[p]),e.useEffect((function(){return window.addEventListener("message",p,!1),function(){window.removeEventListener("message",p,!1)}}),[p]);var v=function(){var e="&scope="+encodeURI(a),r=u||function(e){void 0===e&&(e=20);for(var r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=n.length,o=0;o<e;o++)r+=n.charAt(Math.floor(Math.random()*t));return r}();return localStorage.setItem("linkedin_oauth2_state",r),"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id="+t+"&redirect_uri="+n+e+"&state="+r};return{linkedInLogin:function(){var e;null===(e=w.current)||void 0===e||e.close(),w.current=window.open(v(),"_blank",function(e){var r=e.width,n=void 0===r?600:r,t=e.height,o=void 0===t?600:t;return"left="+(screen.width/2-n/2)+",top="+(screen.height/2-o/2)+",width="+n+",height="+o}({width:600,height:600})),f.current&&(window.clearInterval(f.current),f.current=null),f.current=window.setInterval((function(){try{w.current&&w.current.closed&&(window.clearInterval(f.current),f.current=null,i&&i({error:"user_closed_popup",errorMessage:l}))}catch(e){window.clearInterval(f.current),f.current=null}}),1e3)}}}exports.LinkedIn=function(e){return(0,e.children)({linkedInLogin:n({redirectUri:e.redirectUri,clientId:e.clientId,onSuccess:e.onSuccess,onError:e.onError,state:e.state,scope:e.scope,closePopupMessage:e.closePopupMessage}).linkedInLogin})},exports.LinkedInCallback=function(){var n=e.useState(""),t=n[0],o=n[1];return e.useEffect((function(){var e=function(e){for(var r=e.substring(1).split("&"),n={},t=0;t<r.length;t++){var o=r[t].split("=");o.length>1&&(n[decodeURIComponent(o[0])]=decodeURIComponent(o[1]))}return n}(window.location.search);if(e.state!==localStorage.getItem("linkedin_oauth2_state"))o("State does not match");else if(e.error){var r=e.error_description||"Login failed. Please try again.";window.opener&&window.opener.postMessage({error:e.error,state:e.state,errorMessage:r,from:"Linked In"},window.location.origin),"user_cancelled_login"===e.error&&window.close()}e.code&&window.opener&&window.opener.postMessage({code:e.code,state:e.state,from:"Linked In"},window.location.origin)}),[]),r.jsx("div",{children:t},void 0)},exports.useLinkedIn=n;
//# sourceMappingURL=index.js.map
